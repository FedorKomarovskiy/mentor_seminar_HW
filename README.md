# üöÄ –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞ Trino: –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ **Trino** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –†–µ—à–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| **Trino Coordinator** | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **PostgreSQL** | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| **MySQL** | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π |
| **MinIO** | –û–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ |
| **Hive Metastore** | –ö–∞—Ç–∞–ª–æ–≥ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–∞–±–ª–∏—Ü |
| **Apache Iceberg** | –§–æ—Ä–º–∞—Ç —Ç–∞–±–ª–∏—Ü –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** –∏ **Docker Compose**
- **Python 3.8+** —Å –ø–∞–∫–µ—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º pip
- **4+ –ì–ë –û–ó–£** –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –°–≤–æ–±–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã: `3306`, `5432`, `8080`, `9000`, `9001`, `9083`

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone <your-repo-url>
cd <project-directory>
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cat > .env << 'EOF'
# Database configurations
POSTGRES_DB=demo_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres

MYSQL_ROOT_PASSWORD=mysql
MYSQL_DATABASE=demo_db
MYSQL_USER=mysql
MYSQL_PASSWORD=mysql

# Trino configuration
TRINO_HOST=trino
TRINO_PORT=8080
TRINO_USER=trino

# MinIO credentials
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# Hive Metastore settings
METASTORE_DB=metastore
METASTORE_USER=hive
METASTORE_PASSWORD=hive
EOF
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f
```

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install -r requirements.txt
```

### üåê –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º

| –°–µ—Ä–≤–∏—Å | URL | –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
|--------|-----|----------------|
| **Trino UI** | http://localhost:8080 | - |
| **MinIO Console** | http://localhost:9001 | `minioadmin` / `minioadmin` |

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Trino

```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤
SHOW CATALOGS;

-- –¢–∞–±–ª–∏—Ü—ã –≤ PostgreSQL
SELECT * FROM postgresql.demo_schema.trn_customers;
SELECT * FROM postgresql.demo_schema.trn_orders;

-- –¢–∞–±–ª–∏—Ü—ã –≤ MySQL
SELECT * FROM mysql.demo_schema.trn_payments;

-- –¢–∞–±–ª–∏—Ü—ã –≤ Iceberg
SELECT * FROM iceberg.analytics.daily_reports;
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö)

**PostgreSQL:**
```sql
CREATE TABLE trn_customers (
    customer_id BIGINT PRIMARY KEY,
    customer_name VARCHAR(255),
    email VARCHAR(255),
    created_at TIMESTAMP
);

CREATE TABLE trn_orders (
    order_id BIGINT PRIMARY KEY,
    customer_id BIGINT,
    order_ts TIMESTAMP,
    total_amount DECIMAL(10,2)
);
```

**MySQL:**
```sql
CREATE TABLE trn_payments (
    payment_id BIGINT PRIMARY KEY,
    order_id BIGINT,
    amount DECIMAL(10,2),
    paid_at TIMESTAMP(3),
    payment_method VARCHAR(50)
);
```

## üêç Python –º–æ–¥—É–ª–∏

–ü—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:

### `trino_connection.py`
```python
from trino_connection import create_trino_connection, execute_sql_query

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Trino
conn = create_trino_connection()

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
df = execute_sql_query("SELECT * FROM postgresql.demo_schema.trn_orders")
```

### `data_aggregation.py`
```python
from data_aggregation import (
    aggregate_daily_orders,
    aggregate_daily_payments,
    create_final_analytics_dataframe
)

# –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
daily_orders = aggregate_daily_orders()
daily_payments = aggregate_daily_payments()
analytics_df = create_final_analytics_dataframe()
```

### `visualization.py`
```python
from visualization import (
    create_time_series_revenue_chart,
    create_combined_analytics_dashboard
)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
create_time_series_revenue_chart(analytics_df)
create_combined_analytics_dashboard(analytics_df)
```

### `iceberg_storage.py`
```python
from iceberg_storage import save_analytics_to_iceberg

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Iceberg
save_analytics_to_iceberg(analytics_df, 'analytics.daily_reports')
```

## üìì Jupyter Notebook

–û—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –Ω–æ—É—Ç–±—É–∫–µ `trino_analytics_homework.ipynb`, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏ —ç—Ç–∞–ø–∞:

### –≠—Ç–∞–ø 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Trino
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ö–µ–º –∏ —Ç–∞–±–ª–∏—Ü

### –≠—Ç–∞–ø 2: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ PostgreSQL –∏ MySQL
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –†–∞—Å—á–µ—Ç –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫

### –≠—Ç–∞–ø 3: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Apache Iceberg
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Trino

**–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** (`trino-config/config.properties`):
```properties
coordinator=true
http-server.http.port=8080
discovery.uri=http://localhost:8080
query.max-memory=2GB
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL** (`trino-config/catalog/postgresql.properties`):
```properties
connector.name=postgresql
connection-url=jdbc:postgresql://postgres:5432/demo_db
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Iceberg** (`trino-config/catalog/iceberg.properties`):
```properties
connector.name=iceberg
iceberg.catalog.type=hive_metastore
hive.metastore.uri=thrift://hive-metastore:9083
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ docker-compose.yml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ .env                       # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt           # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ trino_connection.py       # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å Trino
‚îú‚îÄ‚îÄ data_aggregation.py       # –ú–æ–¥—É–ª—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ visualization.py          # –ú–æ–¥—É–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ iceberg_storage.py        # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å Iceberg
‚îú‚îÄ‚îÄ trino_analytics_homework.ipynb  # –û—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫
‚îú‚îÄ‚îÄ trino-config/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Trino
‚îÇ   ‚îú‚îÄ‚îÄ config.properties
‚îÇ   ‚îú‚îÄ‚îÄ node.properties
‚îÇ   ‚îú‚îÄ‚îÄ jvm.config
‚îÇ   ‚îî‚îÄ‚îÄ catalog/
‚îÇ       ‚îú‚îÄ‚îÄ postgresql.properties
‚îÇ       ‚îú‚îÄ‚îÄ mysql.properties
‚îÇ       ‚îî‚îÄ‚îÄ iceberg.properties
‚îî‚îÄ‚îÄ data/                     (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:

```bash
# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Trino
python -c "from trino_connection import test_catalog_connectivity; test_catalog_connectivity()"

# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
python -c "from trino_connection import test_data_access; test_data_access()"
```

## üóëÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Ç–æ–º–æ–≤
docker-compose down -v

# –û—á–∏—Å—Ç–∫–∞ Docker
docker system prune -a --volumes
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Trino
docker-compose logs trino

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –î–æ—Å—Ç—É–ø –∫ –æ–±–æ–ª–æ—á–∫–µ Trino
docker exec -it trino trino

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart trino
```

---

‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É –Ω–∞ GitHub!
